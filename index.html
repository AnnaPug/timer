<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Neon Timer Editor</title>

<style>
:root{color-scheme:dark}
*{box-sizing:border-box}

body{
  margin:0;
  padding:24px;
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
  background:radial-gradient(circle at top,#16163b,#050712 60%,#02030a);
  color:#f5f5ff;
}

h1{
  margin:0 0 10px;
  text-transform:uppercase;
  letter-spacing:.08em;
  text-shadow:0 0 16px #63f2ff;
}

.layout{display:flex;gap:20px;flex-wrap:wrap}

.panel{
  background:linear-gradient(145deg,#090c23,#131633);
  border-radius:16px;
  padding:14px;
  box-shadow:0 0 0 1px rgba(102,153,255,.25),
             0 20px 40px rgba(0,0,0,.7);
}

.controls{width:360px}
.preview{width:320px}
.output{flex:1;min-width:300px}

label{font-size:.8rem}
input,textarea{
  width:100%;
  background:#050712;
  border:1px solid #353863;
  border-radius:8px;
  color:#fff;
  padding:6px 8px;
}

textarea{
  min-height:360px;
  font-family:monospace;
  font-size:.78rem;
}

button{
  width:100%;
  margin-top:10px;
  padding:9px;
  border:none;
  border-radius:999px;
  background:linear-gradient(135deg,#4af2c5,#63f2ff);
  font-weight:600;
  cursor:pointer;
}
button:hover{filter:brightness(1.1)}

.hr{border:none;border-top:1px solid #262b4b;margin:10px 0}

/* ===== ANIMATION PICKER ===== */
.anim-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
}
.anim-item{
  padding:10px;
  text-align:center;
  border-radius:10px;
  background:#050712;
  border:1px solid #353863;
  cursor:pointer;
  font-size:.75rem;
}
.anim-item.active{
  border-color:#63f2ff;
  box-shadow:0 0 10px #63f2ff;
}

/* ===== PREVIEW ===== */
.preview-box{
  width:320px;
  height:320px;
  background:#050712;
  border-radius:18px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.timer-root{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}

.timer-outer{
  width:100%;
  height:100%;
  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;
  position:relative;
}

.timer-core{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:65%;
  aspect-ratio:1/1;
  display:flex;
  align-items:center;
  justify-content:center;
}

.timer-time{
  font-size:2.8em;
  text-shadow:0 0 10px currentColor,0 0 24px currentColor;
  user-select:none;
}

.finish-pulse{animation:pulse .6s infinite}
.finish-shake{animation:shake .4s infinite}
.finish-flash{animation:flash .8s infinite}

@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.15)}
  100%{transform:scale(1)}
}
@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  50%{transform:translateX(6px)}
  100%{transform:translateX(0)}
}
@keyframes flash{
  0%,100%{opacity:1}
  50%{opacity:.3}
}

.restart-btn{
  position:absolute;
  bottom:-34px;
  padding:6px 14px;
  font-size:.7rem;
  border-radius:999px;
  background:#63f2ff;
  color:#02030a;
  cursor:pointer;
}
</style>

<link id="fontLink" rel="stylesheet">
</head>

<body>

<h1>Neon Timer Editor</h1>

<div class="layout">

<!-- CONTROLS -->
<div class="panel controls">

<label>Длительность (сек)</label>
<input type="number" id="duration" value="30">

<label>Шрифт (Google Fonts)</label>
<input id="font" value="Emilys Candy">

<label>Размер цифр (em)</label>
<input type="number" step="0.1" id="fontSize" value="2.8">

<label>Фон (URL)</label>
<input id="bg">

<label>Цвет цифр</label>
<input type="color" id="digitColor" value="#e9f8ff">

<div class="hr"></div>

<label>Анимация окончания</label>
<div class="anim-grid" id="animGrid">
  <div class="anim-item active" data-anim="none">Нет</div>
  <div class="anim-item" data-anim="pulse">Pulse</div>
  <div class="anim-item" data-anim="shake">Shake</div>
  <div class="anim-item" data-anim="flash">Flash</div>
</div>

<label>
  <input type="checkbox" id="autoRestart"> Автоперезапуск
</label>

<button id="generateBtn">Сгенерировать код</button>

</div>

<!-- PREVIEW -->
<div class="panel preview">
<div class="preview-box">
  <div class="timer-root">
    <div class="timer-outer" id="pOuter">
      <div class="timer-core">
        <div class="timer-time" id="pTime">0:30</div>
        <div class="restart-btn" id="pRestart">Restart</div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- OUTPUT -->
<div class="panel output">
<textarea id="output"></textarea>
</div>

</div>

<script>
const state={
  duration:30,
  font:'Emilys Candy',
  fontSize:2.8,
  bg:'',
  digitColor:'#e9f8ff',
  finishAnim:'none',
  autoRestart:false
};

let timerId=null,remain=state.duration;

const pTime=document.getElementById('pTime');
const pOuter=document.getElementById('pOuter');
const fontLink=document.getElementById('fontLink');

function applyPreview(){
  fontLink.href=`https://fonts.googleapis.com/css2?family=${state.font.replace(/\s+/g,'+')}&display=swap`;
  pTime.style.fontFamily=`'${state.font}',cursive`;
  pTime.style.fontSize=state.fontSize+'em';
  pTime.style.color=state.digitColor;
  pOuter.style.backgroundImage=state.bg?`url("${state.bg}")`:'none';
}

function startPreview(){
  clearInterval(timerId);
  remain=state.duration;
  pTime.className='timer-time';

  function tick(){
    pTime.textContent=format(remain);
    if(remain<=0){
      if(state.finishAnim!=='none')
        pTime.classList.add('finish-'+state.finishAnim);
      if(state.autoRestart){
        setTimeout(startPreview,800);
      }
      return;
    }
    remain--;
  }
  tick();
  timerId=setInterval(tick,1000);
}

function format(s){
  return Math.floor(s/60)+':'+(s%60<10?'0':'')+(s%60);
}

/* INPUTS */
['duration','font','fontSize','bg','digitColor'].forEach(id=>{
  document.getElementById(id).addEventListener('input',e=>{
    state[id]=e.target.type==='number'?+e.target.value:e.target.value;
    applyPreview();
    startPreview();
    generate();
  });
});

document.getElementById('autoRestart').onchange=e=>{
  state.autoRestart=e.target.checked;
};

document.querySelectorAll('.anim-item').forEach(el=>{
  el.onclick=()=>{
    document.querySelectorAll('.anim-item').forEach(i=>i.classList.remove('active'));
    el.classList.add('active');
    state.finishAnim=el.dataset.anim;
    startPreview();
    generate();
  };
});

document.getElementById('pRestart').onclick=startPreview;

/* GENERATOR */
function generate(){
  document.getElementById('output').value=
`<div id="timer">0:00</div>
<button onclick="restart()">Restart</button>
<script>
let total=${state.duration},r=total,tid;
const el=document.getElementById('timer');
function f(s){return Math.floor(s/60)+':'+(s%60<10?'0':'')+(s%60)}
function start(){
 clearInterval(tid);r=total;
 el.className='';
 tid=setInterval(()=>{
  el.textContent=f(r);
  if(r<=0){
   ${state.finishAnim!=='none'?"el.classList.add('finish-"+state.finishAnim+"');":''}
   ${state.autoRestart?'start();':''}
   return;
  }
  r--;
 },1000);
}
function restart(){start()}
start();
<\/script>`;
}

document.getElementById('generateBtn').onclick=generate;

applyPreview();
startPreview();
generate();
</script>

</body>
</html>
