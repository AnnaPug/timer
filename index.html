<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Таймер Редактор</title>
<style>
:root{color-scheme: dark;}
*{box-sizing:border-box;}
body{
  margin:0; padding:16px;
  font-family:system-ui,sans-serif;
  background:#0b1020; color:#e9f8ff;
  display:flex; gap:16px;
}
.panel{
  background:#0f1733; padding:12px; border-radius:12px;
  flex-shrink:0;
  max-width:300px;
}
input,select,button{width:100%; margin-top:4px; padding:6px; border-radius:6px; border:none;}
button{margin-top:12px; background:#63f2ff; color:#02030a; cursor:pointer; font-weight:600;}
.anim-list{display:flex; gap:6px; margin-top:6px;}
.anim{flex:1; text-align:center; padding:4px; background:#18214a; border-radius:6px; cursor:pointer; font-size:.75rem;}
.anim.active{outline:2px solid #63f2ff;}
#preview{flex:1; background:#02030a; display:flex; align-items:center; justify-content:center;}
iframe{width:100%; height:100%; border:none;}
textarea{width:100%; margin-top:12px; height:200px; background:#02030a; color:#63f2ff; font-family:monospace; resize:vertical;}
</style>
</head>
<body>

<div class="panel">
  <h2>Редактор Таймера</h2>
  <label>Длительность (сек)</label>
  <input type="number" id="duration" value="30">
  <label>Шрифт</label>
  <select id="font">
    <option>Arial</option>
    <option>Courier New</option>
    <option>Verdana</option>
    <option>Tahoma</option>
  </select>
  <label>Размер цифр (em)</label>
  <input type="number" step="0.1" id="fontSize" value="3">
  <label>Фон таймера (URL)</label>
  <input type="text" id="bgUrl" value="https://i.postimg.cc/28yZbpGP/Chat-GPT-Image-19-noab-2025-g-21-37-10.png">
  <label>Анимация окончания</label>
  <div class="anim-list">
    <div class="anim active" data-anim="none">None</div>
    <div class="anim" data-anim="pulse">Pulse</div>
    <div class="anim" data-anim="shake">Shake</div>
    <div class="anim" data-anim="flash">Flash</div>
  </div>
  <label><input type="checkbox" id="autoStart" checked> Автозапуск</label>
  <label><input type="checkbox" id="autoRestart"> Автоперезапуск</label>
  <button id="generateBtn">Сгенерировать код</button>
</div>

<div id="preview">
  <iframe id="frame"></iframe>
</div>

<textarea id="output" placeholder="HTML для Genially"></textarea>

<script>
// состояние
const state={
  duration:30, font:'Arial', fontSize:3,
  bgUrl:'https://i.postimg.cc/28yZbpGP/Chat-GPT-Image-19-noab-2025-g-21-37-10.png',
  finishAnim:'none', autoStart:true, autoRestart:false
};

const frame=document.getElementById('frame');
const durationInput=document.getElementById('duration');
const fontInput=document.getElementById('font');
const fontSizeInput=document.getElementById('fontSize');
const bgUrlInput=document.getElementById('bgUrl');
const autoStartInput=document.getElementById('autoStart');
const autoRestartInput=document.getElementById('autoRestart');
const output=document.getElementById('output');
const animEls=document.querySelectorAll('.anim');

// обновление состояния
function updateState(){
  state.duration=+durationInput.value;
  state.font=fontInput.value;
  state.fontSize=+fontSizeInput.value;
  state.bgUrl=bgUrlInput.value.trim();
  state.autoStart=autoStartInput.checked;
  state.autoRestart=autoRestartInput.checked;
  renderPreview();
}

// анимации
animEls.forEach(el=>{
  el.onclick=()=>{
    animEls.forEach(a=>a.classList.remove('active'));
    el.classList.add('active');
    state.finishAnim=el.dataset.anim;
    renderPreview();
  };
});

// события input
[durationInput,fontInput,fontSizeInput,bgUrlInput,autoStartInput,autoRestartInput].forEach(el=>{
  el.oninput=updateState;
  el.onchange=updateState;
});

// генерация HTML
function generateHTML(preview){
  return `<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
html,body{margin:0;padding:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:transparent;}
#timer-container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;}
#timer-bg{position:absolute;width:100%;height:100%;object-fit:contain;top:0;left:0;z-index:0;}
#timer{font-family:'${state.font}',sans-serif;font-size:${state.fontSize}em;color:#e9f8ff;z-index:1;text-align:center;}
button{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);padding:6px 12px;border:none;border-radius:999px;background:#63f2ff;color:#02030a;cursor:pointer;}
.finish-pulse{animation:pulse .6s infinite}
.finish-shake{animation:shake .4s infinite}
.finish-flash{animation:flash .8s infinite}
@keyframes pulse{50%{transform:scale(1.15)}}
@keyframes shake{25%{transform:translateX(-6px)}50%{transform:translateX(6px)}}
@keyframes flash{50%{opacity:.3}}
</style>
</head>
<body>
<div id="timer-container">
${state.bgUrl?`<img id="timer-bg" src="${state.bgUrl}">`:''}
<div id="timer">0:00</div>
<button onclick="restart()">Restart</button>
<script>
let total=${state.duration};
let remaining=total;
let el=document.getElementById('timer');
let interval=null;

function format(s){return Math.floor(s/60)+':'+(s%60<10?'0':'')+(s%60);}
function start(){clearInterval(interval);remaining=total;el.className='';tick();interval=setInterval(tick,1000);}
function tick(){el.textContent=format(remaining);if(remaining<=0){${state.finishAnim!=='none'?`el.classList.add('finish-${state.finishAnim}');`:''}clearInterval(interval);${state.autoRestart?'setTimeout(start,800);':''}return;}remaining--;}
function restart(){start();}
${state.autoStart?'start();':''}
</script>
</div>
</body>
</html>`;
}

// обновление preview
function renderPreview(){
  frame.srcdoc=generateHTML(true);
}

// кнопка генерации
document.getElementById('generateBtn').onclick=()=>{
  output.value=generateHTML(false);
};

// старт preview
renderPreview();
</script>

</body>
</html>
